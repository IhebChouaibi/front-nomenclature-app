<div class="sidebar">
  <h2>Recherche & Navigation</h2>
  <div class="search-section">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        placeholder="rechercher un nomenclature" 
        (keyup.enter)="onSearch()">
      <button (click)="onSearch()">Rechercher</button>
    </div>
  </div>
  
  <div class="table-container">
    <h3>Liste des Sections</h3>
    <table>
      <tbody>
        <ng-container *ngFor="let section of sectionsData?.content">
          <tr>
            <td>Section {{ section.codeSection }} :</td>
            <td>
              <ng-container *ngIf="state.editingSectionId !== section.idSection; ">
                {{ section.libelleSection }}
              </ng-container>
             
            </td>
            <td>
              <button 
                (click)="toggleChapitres(section.idSection)" 
                class="toggle-button">
                {{ state.expandedSectionId === section.idSection ?  'üóÅ':'üóÄ' }}
              </button>
            </td>
            <td class="action-cell">
              <div class="dropdown">
                <button class="dropdown-toggle">‚ãÆ</button>
                <div class="dropdown-menu">
                  <button (click)="startEdit('section', section.idSection)">Modifier</button>
                  <button (click)="addChapitre(section.idSection)"> Add Chapitre {{section.idSection}}</button>
                  <button (click)="deleteItem('section', section.idSection)">Supprimer</button>
                </div>
              </div>
            </td>
            
          </tr>

          
          <tr *ngIf="state.expandedSectionId === section.idSection" class="chapitres-row">
            <td colspan="4">
              <ul class="chapitres-list">
                <li *ngFor="let chapitre of section.chapitres">
                  <div 
                    class="chapitre-item" 
                    (click)="selectChapitre(chapitre)" 
                    [class.selected]="selectedChapitreId === chapitre.idChapitre">
                    <span class="chapitre-code">Chapitre {{ chapitre.codeChapitre }}:</span>
                    <ng-container *ngIf="state.editingChapitreId !== chapitre.idChapitre;">
                      <span class="chapitre-libelle">{{ chapitre.libelleChapitre }}</span>
                    </ng-container>
                    
                    <div class="dropdown">
                      <button class="dropdown-toggle">‚ãÆ</button>
                      <div class="dropdown-menu">
                        <button (click)="startEdit('chapitre', chapitre.idChapitre)">Modifier</button>

                        <button (click)="deleteItem('chapitre', chapitre.idChapitre); $event.stopPropagation()">Supprimer</button>
                      </div>
                    </div>
                  </div>
                </li>
                
              </ul>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
    <div class="pagination" *ngIf="sectionsData">
      <button 
        *ngFor="let page of getPages(); let i = index" 
        (click)="changePage(i)" 
        [class.active]="i === currentPage">
        {{ i + 1 }}
      </button>
    </div>
  </div>
</div>